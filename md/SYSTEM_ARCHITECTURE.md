# ğŸ¥‹ CodeDojo Dual Authentication System - Visual Guide

## System Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CODEDOJO APPLICATION                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚            UNIFIED LOGIN PAGE (/login.php)              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚  â”‚  [Admin]          [User]                         â”‚    â”‚  â”‚
â”‚  â”‚  â”‚                                                 â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  Username: ________________                     â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  Password: ________________                     â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  [Sign In]  or  [Sign Up]                      â”‚    â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                  â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚                  â”‚                       â”‚                      â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚         â”‚  ADMIN FLOW       â”‚   â”‚  USER FLOW     â”‚             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                  â”‚                      â”‚                      â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚  config/auth.php          â”‚    â”‚  config/auth.php     â”‚  â”‚
â”‚    â”‚  authenticateAdmin()       â”‚    â”‚  authenticateUser()  â”‚  â”‚
â”‚    â”‚  createUserSession()       â”‚    â”‚  registerUser()      â”‚  â”‚
â”‚    â”‚  verifyPassword()          â”‚    â”‚  createUserSession() â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                  â”‚                      â”‚                      â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚    Database: admins       â”‚   â”‚  Database: users     â”‚  â”‚
â”‚    â”‚  â”œâ”€ id                    â”‚   â”‚  â”œâ”€ id               â”‚  â”‚
â”‚    â”‚  â”œâ”€ username              â”‚   â”‚  â”œâ”€ username         â”‚  â”‚
â”‚    â”‚  â”œâ”€ email                 â”‚   â”‚  â”œâ”€ email            â”‚  â”‚
â”‚    â”‚  â”œâ”€ password (bcrypt)     â”‚   â”‚  â”œâ”€ password (bcrypt)â”‚  â”‚
â”‚    â”‚  â”œâ”€ is_active             â”‚   â”‚  â”œâ”€ first_name       â”‚  â”‚
â”‚    â”‚  â””â”€ timestamps            â”‚   â”‚  â”œâ”€ last_name        â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â””â”€ timestamps       â”‚  â”‚
â”‚                  â”‚                  â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚    â”‚     $_SESSION Created           â”‚                        â”‚
â”‚    â”‚   â”œâ”€ logged_in: true            â”‚                        â”‚
â”‚    â”‚   â”œâ”€ user_id: <id>              â”‚                        â”‚
â”‚    â”‚   â”œâ”€ username: <name>           â”‚                        â”‚
â”‚    â”‚   â”œâ”€ role: 'admin' or 'user'    â”‚                        â”‚
â”‚    â”‚   â””â”€ last_activity: <time>      â”‚                        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                   â”‚                                            â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚     â”‚                            â”‚                            â”‚
â”‚  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  ADMIN DASHBOARD    â”‚   â”‚  USER DASHBOARD        â”‚        â”‚
â”‚  â”‚  /admin/            â”‚   â”‚  /user/                â”‚        â”‚
â”‚  â”‚  - Manage lessons   â”‚   â”‚  - View progress       â”‚        â”‚
â”‚  â”‚  - Manage tasks     â”‚   â”‚  - Recent practices    â”‚        â”‚
â”‚  â”‚  - View practices   â”‚   â”‚  - Continue learning   â”‚        â”‚
â”‚  â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚     â”‚                        â”‚                               â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                   â”‚                                           â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚            â”‚  LOGOUT     â”‚                                    â”‚
â”‚            â”‚ Destroy     â”‚                                    â”‚
â”‚            â”‚ Session     â”‚                                    â”‚
â”‚            â”‚ Redirect to â”‚                                    â”‚
â”‚            â”‚ /login.php  â”‚                                    â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Security Layer

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             INPUT                                            â”‚
â”‚  (Username & Password from Form)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  1. Input Validation             2. Session Timeout      â”‚  â”‚
â”‚     âœ“ Not empty                      âœ“ 30 min check      â”‚  â”‚
â”‚     âœ“ Sanitized                      âœ“ Auto logout       â”‚  â”‚
â”‚     âœ“ Type checked                                        â”‚  â”‚
â”‚                                                              â”‚
â”‚  3. Database Query                4. Password Hashing     â”‚  â”‚
â”‚     âœ“ Prepared statements            âœ“ Bcrypt (cost 10)  â”‚  â”‚
â”‚     âœ“ Parameterized                  âœ“ Never plaintext   â”‚  â”‚
â”‚     âœ“ No string concat               âœ“ Salted hash       â”‚  â”‚
â”‚                                                              â”‚
â”‚  5. Session Security              6. Access Control       â”‚  â”‚
â”‚     âœ“ Unique ID                      âœ“ Role-based        â”‚  â”‚
â”‚     âœ“ Server-side stored             âœ“ Auth middleware   â”‚  â”‚
â”‚     âœ“ httpOnly cookie                âœ“ Redirects         â”‚  â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ File Organization

```
codedojo2/
â”‚
â”œâ”€â”€ ğŸ”“ Public Pages (No Auth Required)
â”‚   â”œâ”€â”€ index.php                    [Homepage]
â”‚   â”œâ”€â”€ editor.php                   [Code editor]
â”‚   â”œâ”€â”€ lessons.php                  [Lessons list]
â”‚   â””â”€â”€ login.php          âœ¨ NEW     [Login & Registration]
â”‚
â”œâ”€â”€ ğŸ” Protected: Admin Area
â”‚   â””â”€â”€ admin/
â”‚       â”œâ”€â”€ auth_check.php â­ UPDATED [Require admin login]
â”‚       â”œâ”€â”€ dashboard.php            [Admin home]
â”‚       â”œâ”€â”€ manage_lessons.php        [Edit lessons]
â”‚       â”œâ”€â”€ manage_tasks.php          [Edit tasks]
â”‚       â”œâ”€â”€ view_practices.php        [View user work]
â”‚       â”œâ”€â”€ logout.php    â­ UPDATED  [Logout handler]
â”‚       â””â”€â”€ account_manager.php âœ¨ NEW [Create accounts]
â”‚
â”œâ”€â”€ ğŸ” Protected: User Area
â”‚   â””â”€â”€ user/              âœ¨ NEW
â”‚       â”œâ”€â”€ auth_check.php           [Require user login]
â”‚       â”œâ”€â”€ dashboard.php            [User home]
â”‚       â””â”€â”€ logout.php               [Logout handler]
â”‚
â”œâ”€â”€ âš™ï¸ Configuration
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ database.php             [DB connection]
â”‚   â”‚   â””â”€â”€ auth.php      âœ¨ NEW     [Auth functions]
â”‚   â””â”€â”€ database/
â”‚       â””â”€â”€ add_auth_tables.sql âœ¨ NEW [DB migration]
â”‚
â”œâ”€â”€ ğŸ¨ Assets
â”‚   â”œâ”€â”€ assets/
â”‚   â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ js/
â”‚   â””â”€â”€ includes/
â”‚       â”œâ”€â”€ header.php     â­ UPDATED [Added auth menu]
â”‚       â””â”€â”€ footer.php
â”‚
â””â”€â”€ ğŸ“š Documentation
    â”œâ”€â”€ README.md
    â”œâ”€â”€ INSTALLATION.md
    â”œâ”€â”€ ADMIN_GUIDE.md
    â”œâ”€â”€ AUTHENTICATION.md             âœ¨ NEW [Full tech docs]
    â”œâ”€â”€ AUTHENTICATION_SETUP.md       âœ¨ NEW [Setup guide]
    â”œâ”€â”€ AUTHENTICATION_QUICK_REFERENCE.md âœ¨ NEW [Quick ref]
    â””â”€â”€ IMPLEMENTATION_SUMMARY.md     âœ¨ NEW [Summary]

Legend:
  âœ¨ NEW - Newly created file
  â­ UPDATED - Modified existing file
```

---

## ğŸ”„ Request Flow Diagram

### Admin Login Flow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. User visits /login.php                    â”‚
â”‚    - Sees role selection (Admin/User)        â”‚
â”‚    - Enters credentials                      â”‚
â”‚    - Clicks "Sign In"                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ POST request
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. authenticateAdmin()                       â”‚
â”‚    - Get username & password from POST       â”‚
â”‚    - Query admins table                      â”‚
â”‚    - Verify password hash with bcrypt       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ 
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚
    âœ“ Match           âœ— No Match
        â”‚                   â”‚
        â–¼                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Return â”‚          â”‚ Return false   â”‚
    â”‚ admin  â”‚          â”‚ Show error msg â”‚
    â”‚record  â”‚          â”‚ Stay on login  â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 3. createUserSession()            â”‚
    â”‚    $_SESSION['logged_in']=true    â”‚
    â”‚    $_SESSION['user_id']=$id       â”‚
    â”‚    $_SESSION['username']=$name    â”‚
    â”‚    $_SESSION['role']='admin'      â”‚
    â”‚    $_SESSION['email']=$email      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 4. Redirect to                   â”‚
    â”‚    /admin/dashboard.php          â”‚
    â”‚    - Session set on client       â”‚
    â”‚    - Admin content displayed     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### User Registration Flow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Click "Create one now"                    â”‚
â”‚    - Show registration form                  â”‚
â”‚    - Fields:                                 â”‚
â”‚      â€¢ First Name (optional)                 â”‚
â”‚      â€¢ Last Name (optional)                  â”‚
â”‚      â€¢ Username (required)                   â”‚
â”‚      â€¢ Email (required)                      â”‚
â”‚      â€¢ Password (required, min 6 chars)      â”‚
â”‚      â€¢ Confirm Password (required)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ Form submission
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. registerUser()                            â”‚
â”‚    - Validate all fields                     â”‚
â”‚    - Check username unique                   â”‚
â”‚    - Check email unique                      â”‚
â”‚    - Check password length >= 6              â”‚
â”‚    - Check passwords match                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                   â”‚
 âœ“ Valid          âœ— Invalid
    â”‚                   â”‚
    â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Hash pass â”‚      â”‚ Show errors â”‚
â”‚ Insert    â”‚      â”‚ in form     â”‚
â”‚ into DB   â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Auto-login new user           â”‚
â”‚    createUserSession()            â”‚
â”‚    - Set all session variables    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 4. Redirect to           â”‚
    â”‚    /user/dashboard.php   â”‚
    â”‚    - User account ready  â”‚
    â”‚    - Can start learning  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Access Control Matrix

```
                    Public  Admin  User   Logged Out
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
index.php             âœ“      âœ“     âœ“        âœ“
editor.php            âœ“      âœ“     âœ“        âœ“
lessons.php           âœ“      âœ“     âœ“        âœ“
my_practice.php       âœ“      âœ“     âœ“        âœ“
login.php             âœ“      -     -        âœ“
/admin/dashboard      -      âœ“     -        -
/admin/manage_*       -      âœ“     -        -
/user/dashboard       -      -     âœ“        -
/user/logout          -      -     âœ“        -
/admin/logout         -      âœ“     -        -

Legend:
  âœ“ = Accessible
  - = Blocked/Redirected
```

---

## ğŸ”‘ Session Lifecycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User not logged in                              â”‚
â”‚ $_SESSION['logged_in'] = not set                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ User submits login form
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Authentication successful                       â”‚
â”‚ $_SESSION['logged_in'] = true       (Line 1)    â”‚
â”‚ $_SESSION['role'] = 'admin'/'user'  (Line 2)    â”‚
â”‚ $_SESSION['user_id'] = 1            (Line 3)    â”‚
â”‚ $_SESSION['last_activity'] = time() (Line 4)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚
    Page 1            Page 2-N
    Visit             Subsequent Visits
        â”‚                 â”‚
        â”‚                 â–¼
        â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         â”‚ checkSessionTimeout()â”‚
        â”‚         â”‚ Is 30 min passed?   â”‚
        â”‚         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚               â”‚      â”‚
        â”‚           No  â”‚      â”‚ Yes
        â”‚               â–¼      â–¼
        â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         â”‚Log out    â”‚
        â”‚         â”‚Expire     â”‚
        â”‚         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
        â”‚               â”‚
        â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Session Destroyed           â”‚
â”‚ User redirected to login    â”‚
â”‚ Must authenticate again     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Flow on Page Load

```
User requests /admin/dashboard.php
â”‚
â”œâ”€â–º Session starts
â”œâ”€â–º File includes admin/auth_check.php
â”‚   â”‚
â”‚   â”œâ”€â–º Include config/auth.php
â”‚   â”‚   (Sets up auth functions)
â”‚   â”‚
â”‚   â”œâ”€â–º requireLogin('admin', 'login.php')
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â–º isLoggedIn()?
â”‚   â”‚   â”‚   NO â†’ header('Location: login.php') â†’ Exit
â”‚   â”‚   â”‚   YES â†“
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â–º getUserRole() === 'admin'?
â”‚   â”‚   â”‚   NO â†’ header('Location: login.php?error=unauthorized') â†’ Exit
â”‚   â”‚   â”‚   YES â†“
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â–º checkSessionTimeout()
â”‚   â”‚       Time since last activity > 1800?
â”‚   â”‚       YES â†’ logoutUser() â†’ Redirect to login
â”‚   â”‚       NO â†’ $_SESSION['last_activity'] = now() â†’ Continue
â”‚   â”‚
â”‚   â””â”€â–º Auth passed! Continue loading page
â”‚
â”œâ”€â–º Load page content
â”œâ”€â–º Render HTML
â””â”€â–º Send to browser
```

---

## ğŸ” Password Security Implementation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ USER INPUT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Plain text password: "MyPassword123"               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  hashPassword()             â”‚
       â”‚  password_hash()            â”‚
       â”‚  Algorithm: bcrypt          â”‚
       â”‚  Cost Factor: 10            â”‚
       â”‚  Rounds: 2^10 = 1024        â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Generated Hash:           â”‚
        â”‚ $2y$10$N9qo8uLO...       â”‚
        â”‚ (60 characters)          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Stored in Database        â”‚
        â”‚ passwords are always hashed
        â”‚ Can never be reversed     â”‚
        â”‚ Unique every time         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        When user logs in:
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ User enters: "MyPassword" â”‚
        â”‚                           â”‚
        â”‚ verifyPassword()          â”‚
        â”‚ password_verify()         â”‚
        â”‚                           â”‚
        â”‚ Compares to hash          â”‚
        â”‚ Match? â†’ Grant access     â”‚
        â”‚ No match? â†’ Deny access   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”˜
```

---

## ğŸ“± Responsive Design

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Desktop View (>768px)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Sidebar    â”‚  Content Area           â”‚  â”‚
â”‚ â”‚ - Menu     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  â”‚
â”‚ â”‚ - Nav      â”‚  â”‚ Login Form         â”‚â”‚  â”‚
â”‚ â”‚ - Profile  â”‚  â”‚ with both options  â”‚â”‚  â”‚
â”‚ â”‚            â”‚  â”‚ [Admin] [User]     â”‚â”‚  â”‚
â”‚ â”‚            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mobile View (<768px)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ [â˜° Menu]                             â”‚  â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚ â”‚ â”‚  CodeDojo Login                  â”‚ â”‚  â”‚
â”‚ â”‚ â”‚  [Admin] [User]                  â”‚ â”‚  â”‚
â”‚ â”‚ â”‚                                  â”‚ â”‚  â”‚
â”‚ â”‚ â”‚  Username: [_____________]       â”‚ â”‚  â”‚
â”‚ â”‚ â”‚  Password: [_____________]       â”‚ â”‚  â”‚
â”‚ â”‚ â”‚  [Sign In]                       â”‚ â”‚  â”‚
â”‚ â”‚ â”‚                                  â”‚ â”‚  â”‚
â”‚ â”‚ â”‚  [Don't have account? Sign Up]   â”‚ â”‚  â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… Testing Scenarios

```
âœ“ Happy Path (Admin)
  â””â”€â–º Go to login.php
      â””â”€â–º Select "Admin"
          â””â”€â–º Enter: admin / codedojo123
              â””â”€â–º Redirects to /admin/dashboard.php
                  â””â”€â–º Page loads successfully

âœ“ Happy Path (User)
  â””â”€â–º Go to login.php
      â””â”€â–º Select "User"
          â””â”€â–º Enter: user / user123
              â””â”€â–º Redirects to /user/dashboard.php
                  â””â”€â–º Page loads successfully

âœ“ Registration
  â””â”€â–º Click "Create one now"
      â””â”€â–º Fill form
          â””â”€â–º Click "Create Account"
              â””â”€â–º Auto-logged in
                  â””â”€â–º Redirects to /user/dashboard.php

âœ“ Wrong Password
  â””â”€â–º Enter username / wrong password
      â””â”€â–º Shows error message
          â””â”€â–º Stays on login page

âœ“ Unauthorized Access
  â””â”€â–º User tries /admin/dashboard.php directly
      â””â”€â–º Redirected to login.php
          â””â”€â–º Error message shown

âœ“ Session Timeout
  â””â”€â–º Logged in
      â””â”€â–º Inactive for 30 minutes
          â””â”€â–º Next request
              â””â”€â–º Session cleared
                  â””â”€â–º Redirected to login.php
```

---

## ğŸ“ Key Concepts

**Authentication** = Verifying who you are (login)
**Authorization** = Verifying what you can access (roles)
**Session** = Keeping you logged in across pages
**Hashing** = Converting password to irreversible code
**Bcrypt** = Modern password hashing algorithm

---

**Version**: 2.0 (Dual Authentication)  
**Created**: February 8, 2026  
**Status**: âœ… Production Ready
